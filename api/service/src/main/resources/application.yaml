management:
  server:
    port: 8081
  endpoints:
    web:
      base-path: /
      exposure:
        include: health, prometheus
  metrics:
    distribution:
      percentiles-histogram:
        http:
          server:
            requests: true

security:
  jwt:
    secret: ${JWT_SECRET}
    expiration: 24h
  oauth2:
    redirect-uri: ${UI_ORIGIN:http://localhost:3000}/login
  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:}
  test-bypass:
    enabled: false
  allow-list:
    emails: ${ALLOWED_EMAILS:}
    domains: ${ALLOWED_DOMAINS:}

spring:
  lifecycle:
    timeout-per-shutdown-phase: 30s
  main:
    banner-mode: off
  application:
    name: support-bot
  security:
    oauth2:
      client:
        registration:
          google:
            client-id: ${GOOGLE_CLIENT_ID:}
            client-secret: ${GOOGLE_CLIENT_SECRET:}
            scope: openid, email, profile
          azure:
            client-id: ${AZURE_CLIENT_ID:}
            client-secret: ${AZURE_CLIENT_SECRET:}
            scope: openid, email, profile
            authorization-grant-type: authorization_code
            redirect-uri: "{baseUrl}/login/oauth2/code/{registrationId}"
        provider:
          azure:
            tenant-id: ${AZURE_TENANT_ID:}
            issuer-uri: https://login.microsoftonline.com/${AZURE_TENANT_ID:common}/v2.0
  cloud:
    # Uncomment in case you require Azure integration
#    azure:
#      profile:
#        tenant-id: ${AZURE_TENANT_ID}
#      credential:
#        client-id: ${AZURE_CLIENT_ID}
#        client-secret: ${AZURE_CLIENT_SECRET}
    gcp:
      core:
        enabled: true
      credentials:
        scopes: [ "https://www.googleapis.com/auth/cloud-identity.groups.readonly" ]
  datasource:
    url: ${DB_URL:jdbc:postgresql://localhost:5432/postgres}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:postgres}
    hikari:
      data-source-properties:
        reWriteBatchedInserts: true

slack:
  mode: socket # socket or http
  enable-request-verification: true
  client:
    methods-base-url: ""
  creds:
    token: ${SLACK_TOKEN} # Token like: xoxb-abc-def
    socket-token: ${SLACK_SOCKET_TOKEN} # Token like: xapp-1-abc-def-ghi
    signing-secret: ${SLACK_SIGNING_SECRET} # Token like: 1234567890abcdef
  ticket:
    channel-id: ${SLACK_TICKET_CHANNEL_ID} # Channel ID like: C1234567890
    expected-initial-reaction: eyes
    response-initial-reaction: ticket
    resolved-reaction: white_check_mark
    escalated-reaction: rocket

ticket:
  staleness-check-job:
    enabled: true
    find-stale-cron: 0 0 9 * * 1-5
    time-to-stale: 3d
    remind-about-stale-cron: 0 10 9 * * 1-5
    stale-reminder-interval: 1d
  assignment:
    enabled: true
    encryption:
      enabled: true
      key: ${TICKET_ASSIGNMENT_ENCRYPTION_KEY:}
enums:
  escalation-teams:
    - label: Core Community
      code: core-community
      slack-group-id: S08948NBMED
    - label: Escalation Team 1 Test
      code: Escalation Team 1 Test
      slack-group-id: S08948NBMED
    - label: Escalation Team 2 Test
      code: Escalation Team 2 Test
      slack-group-id: S08948NBMED
  tags:
    - label: Ingresses
      code: ingresses
    - label: Jenkins Pipelines
      code: jenkins-pipelines
    - label: Networking
      code: networking
    - label: Vault
      code: vault
    - label: Persistence/Brokers
      code: persistence-brokers
    - label: Observability
      code: observability
    - label: DNS
      code: dns
    - label: Osprey
      code: osprey
  impacts:
    - label: Production Blocking
      code: productionBlocking
    - label: BAU Blocking
      code: bauBlocking
    - label: Abnormal Behaviour
      code: abnormalBehaviour

platform-integration:
  enabled: true
  fetch:
    max-concurrency: 64
    timeout: 30s
    ignore-unknown-teams: true # Whether to check for unknown escalation teams and fail if any are found
  kubernetes:
    disable-http-proxy: false
    base-url: ""
  gcp:
    enabled: true
    app-name: Support Bot
    client:
      base-url: ""
  static-user:
    enabled: false
    users:
      wow-group:
        - wow1@test.com
      infra-group:
        - infra1@test.com
        - infra2@test.com
        - infra3@test.com
      connected-app-group:
        - connected-app1@test.com
        - connected-app2@test.com
        - connected-app3@test.com
  azure:
    enabled: false
    client:
      base-url: ""
      log-level: ${AZURE_CLIENT_LOG_LEVEL:NONE}
  teams-scraping:
    static:
      enabled: false
      teams:
        - name: CECG Support Tenants
          group-ref: 833843f4-7430-410f-b141-bcf18f807232
        - name: connected-app
          group-ref: 55ca82ca-2877-4a8f-896d-f48d03ce35bb
        - name: infra-integration
          group-ref: 55ca82ca-2877-4a8f-896d-f48d03ce35bb
        - name: wow
          group-ref: 55ca82ca-2877-4a8f-896d-f48d03ce35bb
        - name: Escalation Team 1 Test
          group-ref: 10076c78-37d7-455d-a873-9edb0c2eacdc
        - name: Escalation Team 2 Test
          group-ref: 016e17a8-cdaa-4abb-872d-fe4326a13af2

    core-platform:
      enabled: true
    k8s-generic:
      enabled: false
      config:
        api-group: ""
        api-version: v1
        kind: Namespace
        namespace: null
        filter:
          name-regexp: null
          label-selector: "root.tree.hnc.x-k8s.io/depth"
        teamName:
          jq-expression: .metadata.name
        groupRef:
          jq-expression: .metadata.uid

team:
  support:
    name: Core Support
    code: support
    slack-group-id: S08948NBMED
    static:
      enabled: false
      members:
        - email: coby.ivona@company.com
          slack-id: U0123456781
        - email: sana.chernobog@company.com
          slack-id: U0123456782
        - email: jean.kristijan@company.com
          slack-id: U0123456783
  leadership:
    name: Support Leadership
    code: support-leadership
    slack-group-id: S08948NBMED
    static:
      enabled: false
      members:
        - email: coby.ivona@company.com
          slack-id: U0123456781
        - email: sana.chernobog@company.com
          slack-id: U0123456782
        - email: jean.kristijan@company.com
          slack-id: U0123456783

ai:
  sentiment-analysis:
    enabled: false

mock-data:
  enabled: false

rbac:
  enabled: true

metrics:
  enabled: false
  refresh-interval: 60s

knowledge-gaps:
  enabled: true
